# Обнаружение людей в опасных зонах

Данный проект предназначен для обнаружения людей в заданных опасных зоных на изображениях и видео с использованием модели YOLOv8. Проект позволяет проверять, находятся ли люди в определенных опасных зонах, и сохранять результаты анализа в виде обработанных изображений и видео.

## Установка

### Предварительные требования

Убедитесь, что у вас установлена CUDA. [Устанавливать отсюда](https://developer.nvidia.com/cuda-11-8-0-download-archive).

### Установка проекта

1. Клонируйте репозиторий:

```bash
git clone https://github.com/elmoons/check_human_in_danger_zones.git
```

2. Перейдите в директорию проекта:

```bash
cd check_human_in_danger_zones
```

3. Установите библиотеку YOLO от Ultralytics:

```bash
pip install ultralytics
```

4. Установите необходимые зависимости:

```bash
pip install -r requirements.txt
```

5. Убедитесь, что у вас установлен OpenCV:

```bash
pip install opencv-python
```

6. Убедитесь, что у вас установлен Streamlit

```bash
pip install streamlit
```
7. Сначала удалите, а потом установите PyTorch с поддержкой CUDA, следуя инструкциям на [официальном сайте PyTorch](https://pytorch.org/get-started/locally/):

```bash
pip3 uninstall torch torchvision torchaudio 
```

 ```bash
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```


## Использование

### Запуск проекта

Запустите интерфейс Streamlit:

```bash
streamlit run web.py
```

Загрузите файл для распознавания (изображение или видео) и введите координаты опасной зоны в появившемся окне.

### Пример использования

1. Запуск интерфейса:

```bash
streamlit run web.py
```

2. Ввод пути к файлу и координат опасной зоны в интерфейсе Streamlit:

Введите путь к файлу (изображение или видео) и координаты опасной зоны в формате (x1, y1) (x2, y2) (x3, y3) (x4, y4). Одна зона включает 4 координаты, например:

```plaintext
(100, 100) (400, 200) (600, 500) (200, 400)
```

### Проверка результата

Результаты распознования можно скачать по нажатию кнопки с файлом.

Программа выведет сообщение, находится ли человек в опасной зоне или нет.

### Замечания
1. Координаты опасной зоны должны быть введены в правильном формате, иначе опасная зона не отобразится.
2. Результаты распознавания можно будет сохранить и посмотреть, нажав на кнопку.

```

Этот файл README.md включает инструкции по установке, запуску и использованию проекта, а также описание запуска интерфейса Streamlit для удобного ввода данных.
